<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="CY">
<meta name="description" content="Information and descriptions of how to calculate a priori sample size using G Power">

<title>Calculating a priori sample size using G Power – Visual Neuroscience Lab</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Visual Neuroscience Lab</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../index.html" aria-current="page"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../behavioral.html"> 
<span class="menu-text">Behavioral</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../displays.html"> 
<span class="menu-text">Displays</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../labmeeting.html"> 
<span class="menu-text">Labmeeting</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../mri.html"> 
<span class="menu-text">MRI</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../people.html"> 
<span class="menu-text">People</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../stats.html"> 
<span class="menu-text">Stats</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../contribute.html"> 
<span class="menu-text">how to contribute to the lab website</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../members.html"> 
<span class="menu-text">lab members only</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../other_topics.html"> 
<span class="menu-text">Other Topics</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../other_topics.html">Other Topics</a></li><li class="breadcrumb-item"><a href="../OtherTopics/CalculatingAPrioriPower.html">Calculating a priori sample size using G Power</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mri/neurodesktop/neurodesktop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Neurodesktop access</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../mri/from_DICOMS_to_GLM/Overview_fromDICOMtoGLM.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">MRI: from DICOM to GLM Analysis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mri/from_DICOMS_to_GLM/DICOMtoBIDS.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">01 DICOM to BIDS</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mri/from_DICOMS_to_GLM/ProvidingParticipantsWithTheirT1wFile.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">02 T1w for PBn</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mri/from_DICOMS_to_GLM/defacing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">03 - Defacing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mri/from_DICOMS_to_GLM/RemoveDenoisingScan.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">04 - Removing Noise Scan</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mri/from_DICOMS_to_GLM/run_fmriprep.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">05 fmriprep</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mri/from_DICOMS_to_GLM/troubleshooting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Troubleshooting</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../mri.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">MRI</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mri/3D-prints/3d-prints.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3D printing a brain</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mri/analysis/7t_analysis_on_neurodesk.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">7T anatomical analysis on neurodesk</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mri/analysis/bids.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">MRI BIDS and OSF</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mri/analysis/dicom_to_bids.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Dicom to Bids conversion</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mri/analysis/fmriprep.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">fMRIprep analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mri/analysis/freesurfer FSFAST.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">FreeSurfer FSFAST</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mri/mri-lab-setup-2023/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Old MRI setup</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mri/mri-lab-setup-2024/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Update to the MRI lab setup</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mri/physiology/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Physiological noise correction</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../behavioral.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Behavioral</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../behavioral/2024-05-22/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Vision tests</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../behavioral/2024-05-23/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BIDS for behavioral studies</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../behavioral/chinrests/chinrests.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Custom-built chin rests</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../other_topics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Other Topics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../OtherTopics/CalculatingAPrioriPower.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Calculating a priori sample size using G Power</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../OtherTopics/displays/displays.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Gamma correction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../people/stipends/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Stipends and prizes for master students</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../people/coffee/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Coffee time</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../people/compensation/compensation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Participant compensation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../people/leaving/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Things to do if you are leaving the lab</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../people/writing/writing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Scientific writing in practice</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../OtherTopics/Labmeeting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Labmeeting</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../OtherTopics/LabMembersOnly/LabMembersOnly.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab Members Only!!!</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../OtherTopics/ContributeWithR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Contribute to the website</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../archive.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Archive</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#power-analysis" id="toc-power-analysis" class="nav-link active" data-scroll-target="#power-analysis"><span class="header-section-number">1</span> Power analysis</a></li>
  <li><a href="#gpower" id="toc-gpower" class="nav-link" data-scroll-target="#gpower"><span class="header-section-number">2</span> G*Power</a>
  <ul class="collapse">
  <li><a href="#how-to-calculate-a-priori-sample-size-on-gpower" id="toc-how-to-calculate-a-priori-sample-size-on-gpower" class="nav-link" data-scroll-target="#how-to-calculate-a-priori-sample-size-on-gpower"><span class="header-section-number">2.1</span> How to calculate <em>a priori</em> sample size on G*Power</a></li>
  <li><a href="#repeated-measures-anova-on-gpower" id="toc-repeated-measures-anova-on-gpower" class="nav-link" data-scroll-target="#repeated-measures-anova-on-gpower"><span class="header-section-number">2.2</span> Repeated measures ANOVA on G*Power</a></li>
  </ul></li>
  <li><a href="#power-analysis-by-r-packages" id="toc-power-analysis-by-r-packages" class="nav-link" data-scroll-target="#power-analysis-by-r-packages"><span class="header-section-number">3</span> Power analysis by R packages</a>
  <ul class="collapse">
  <li><a href="#pwr" id="toc-pwr" class="nav-link" data-scroll-target="#pwr"><span class="header-section-number">3.1</span> pwr</a></li>
  <li><a href="#webpower" id="toc-webpower" class="nav-link" data-scroll-target="#webpower"><span class="header-section-number">3.2</span> WebPower</a></li>
  <li><a href="#superpower" id="toc-superpower" class="nav-link" data-scroll-target="#superpower"><span class="header-section-number">3.3</span> Superpower</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../other_topics.html">Other Topics</a></li><li class="breadcrumb-item"><a href="../OtherTopics/CalculatingAPrioriPower.html">Calculating a priori sample size using G Power</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Calculating a priori sample size using G Power</h1>
</div>

<div>
  <div class="description">
    Information and descriptions of how to calculate a priori sample size using G Power
  </div>
</div>


<div class="quarto-title-meta column-body">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>CY </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="power-analysis" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Power analysis</h1>
<p>Power analysis is a statistical technique that helps scientists determine the sample size required to detect an effect of a given size with a desired degree of certainty. It helps researchers understand the likelihood that their study will detect a meaningful difference or relationship (if one exists) between groups or variables being studied. By performing a power analysis before conducting an experiment, scientists can ensure that the study is neither too small (which would result in a lack of statistical power to detect an effect, leading to a possible Type II error) nor too large (which could waste resources and potentially expose participants to unnecessary procedures). It’s a crucial step in the research design process that helps in making informed decisions and in enhancing the credibility and replicability of scientific findings.</p>
<p>You need to calculate a priori sample size according to the statistical test you want to make an argument. For example, if you are interested in only the results of ANOVA comparisons then, you should make your calculation for your ANOVA test. However, if you desire to analyze further with multiple comparisons then, you should calculate required sample size based on your post-hoc method which is commonly paired t test.</p>
</section>
<section id="gpower" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> G*Power</h1>
<p>G*Power is a very popular and free software program that researchers use to conduct power analysis. It was developed by Franz Faul at the Universität Kiel, Germany, and is frequently updated and improved upon. The software is designed to help researchers with a variety of statistical tests, including t-tests, F-tests, chi-squared tests, z-tests, and some exact tests.<br>
<br>
G*Power provides a flexible tool for calculating the required sample size for a study based on the effect size, significance level, and power – which refers to the probability of correctly rejecting a false null hypothesis. Researchers can also use G*Power to calculate the power of their study given the sample size and effect size.<br>
<br>
The program is user-friendly, allowing both beginners and experienced users to carry out a range of power analyses that might otherwise be complex and time-consuming. Its broad applicability across various statistical analyses makes it a valuable tool in the research planning process, helping to ensure that studies are properly designed to yield valid and reliable results.</p>
<p>See <a href="https://www.psychologie.hhu.de/arbeitsgruppen/allgemeine-psychologie-und-arbeitspsychologie/gpower">official page</a> of G*Power</p>
<section id="how-to-calculate-a-priori-sample-size-on-gpower" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="how-to-calculate-a-priori-sample-size-on-gpower"><span class="header-section-number">2.1</span> How to calculate <em>a priori</em> sample size on G*Power</h2>
<p>To calculate an <em>a priori</em> sample size using G*Power, you need to follow several steps. The specific steps might change slightly depending on the statistical test you plan to use, but the overall process is similar:</p>
<ol type="1">
<li><p>Download and Open G*Power</p></li>
<li><p>Choose the Test</p>
<p>In the G*Power interface, select the statistical test that you intend to use from the ‘Test family’ (e.g., t tests, F tests, etc.) and the ‘Statistical test’ (e.g., ANOVA, linear multiple regression, etc.) menus according to the hypothesis of your study.</p></li>
<li><p>Determine the Type of Power Analysis</p>
<p>Since you want to calculate the sample size, you should choose ‘A priori: Compute required sample size - given α, power, and effect size’.</p></li>
<li><p>Input Parameters</p>
<ul>
<li><p><strong>Effect Size</strong>: Estimate the effect size for your desired test, which indicates the magnitude of the relationship or difference that you expect to find. You can use previous literature or pilot studies to estimate this.</p></li>
<li><p><strong>α Error Probability (Significance Level)</strong>: Typically, this is set at 0.05.</p></li>
<li><p><strong>Power (1-β Error Probability)</strong>: Commonly set at 0.80, indicating an 80% chance of detecting an effect if there really is one.</p></li>
<li><p><strong>Allocation Ratio (for comparative studies)</strong>: This is the ratio of the number of participants in one group to the number of participants in the other group(s). For equal group sizes, this is set to 1.</p></li>
</ul></li>
<li><p>Calculate</p>
<p>Once all parameters are entered, click on the ‘Calculate’ button. G*Power will display the required sample size for your study based on the input values.</p></li>
<li><p>Review Output</p>
<p>G*Power will provide the calculated sample size along with other details related to the power analysis. Carefully review this output to determine if it is suitable for the needs of your study.</p></li>
</ol>
<p>Keep in mind that determining these parameters, especially the effect size, can sometimes be the most challenging part of a power analysis. Consult with a statistician, your team members or relevant literature if you are unsure about these inputs. Finally, remember that power analysis is an important part of designing your study, but it should be combined with practical considerations like resource availability, ethical constraints, and methodological limitations.</p>
</section>
<section id="repeated-measures-anova-on-gpower" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="repeated-measures-anova-on-gpower"><span class="header-section-number">2.2</span> Repeated measures ANOVA on G*Power</h2>
<p>As an example, let’s say we have 3 different stimulus types. In each session, we will present one type of stimuli at 4 different contrast levels. The task will be the same throughout the experiment. Our aim is to determine the effect of contrast.</p>
<p>In such a case, we need using a repeated measures ANOVA (or 2-way mixed ANOVA or split-plot ANOVA). Calculating an <em>a priori</em> sample size for a mixed-design ANOVA in GPower can be a bit tricky, as G*Power does not directly provide a pre-built module for mixed ANOVAs with both within- (repeated measures) and between-subjects factors. However, you can still approximate the necessary calculations by considering the most powerful test within your design, which is typically the repeated measures part if the effect sizes are similar. Here is a general guide on how to do this:</p>
<ol type="1">
<li><p>Open G*Power</p></li>
<li><p>Select the Statistical Test</p>
<ul>
<li><p>Choose ‘F tests’ as the test family.</p></li>
<li><p>Choose ‘ANOVA: Repeated measures, within factors’.</p>
<p>(You can also choose ‘ANOVA: Repeated measures, between factors’ depending on which effect you expect to be larger or more important to your hypothesis testing. However, a conservative approach is often to consider the within-effects when uncertain.)</p></li>
</ul></li>
<li><p>Choose the Type of Power Analysis</p>
<ul>
<li>Select ‘A priori: Compute required sample size - given α, power, and effect size’.</li>
</ul></li>
<li><p>Input the Parameters</p>
<ul>
<li><p><strong>Effect Size</strong>: We need to determine the effect size with direct method to count the effect of repeated measure. To do that, click on ‘Determine =)&gt;’. On the pop-up window, select ‘Direct’. Enter eta squared value. Click ‘Calculate and transfer to main window’.</p>
<p>Eta squared (<span class="math inline">\(\eta^{2}\)</span>) is the effect size that indicates the total variance in testing explained by the within-subject variable (in our case, different contrast levels). Approximate partial eta squared conventions are small = 0.02, medium = 0.06, large = 0.14.</p></li>
<li><p><strong>α Error Probability</strong>: The significance level is typically set at 0.05.</p></li>
<li><p><strong>Power</strong>: Set this commonly to 0.80, indicating an 80% probability of correctly rejecting the null hypothesis.</p></li>
<li><p><strong>Number of Groups</strong>: For the between-subjects factor, input the number of levels or conditions. If you compare, for example, healthy vs patient group, the number of groups is 2. For within-subject designs, the number of groups should be 1.</p></li>
<li><p><strong>Number of Measurements</strong>: For the within-subjects factor, input the number of levels or conditions. If you have more than one independent variable, you can compute the number of measurements by multiplying the number of conditions for each factor. For example, if you have three stimulus types (k = 3) each of that is presented at four contrast levels (m = 4), you have 12 measurements (k x m = 3 x 4).</p></li>
<li><p><strong>Correlation among Repeated Measures</strong>: This is determined by the expected correlation between the measures at different levels of contrast. If you don’t have an estimate, using a default value like 0.5 can be a starting point.</p></li>
<li><p><strong>Nonsphericity Correction ε</strong>: If you have an estimate for this, input it here; otherwise, you can keep it at 1 or use the default provided by G*Power.</p></li>
</ul></li>
<li><p>Calculate</p></li>
<li><p>Review Results</p></li>
</ol>
<center>
<img src="./gpower_example.png" class="img-fluid">
</center>
<p>Please note that this approach is an approximation, as it does not fully represent the complexity of a mixed-design ANOVA. It essentially treats the between-subjects factor as another within-subjects level, which may not be totally accurate but can give you a ballpark figure for your sample size. If possible, consult with a statistician to ensure that the calculation is correctly tailored to your study’s specific needs and to take into account other complexities that G*Power may not directly address for mixed designs.</p>
<p>See another example on <a href="https://www.youtube.com/watch?v=NRha9ZEYfI0">YouTube</a></p>
</section>
</section>
<section id="power-analysis-by-r-packages" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Power analysis by R packages</h1>
<p>If you want to use R to calculate your power level or required sample size, you can use one of the available packages depending on your needs.You can use the ready-to-use function with default parameters: <a href="https://github.com/visualneuroscience/visualneuroscience.github.io/blob/main/OtherTopics/power_analysis.R">Script is here.</a></p>
<section id="pwr" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="pwr"><span class="header-section-number">3.1</span> pwr</h2>
<p>This is the most common and basic package for power analysis. However, it is not suitable for complex statistical tests such as repeated measures ANOVA.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pwr<span class="sc">:::</span><span class="fu">pwr.t.test</span>(<span class="at">n =</span> <span class="cn">NULL</span>,  <span class="co"># NULL to calculate a priori sample size</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">d =</span> <span class="fl">0.4</span>,  <span class="co"># Cohen's d, effect size</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">sig.level =</span> <span class="fl">0.05</span>,  <span class="co"># alpha value</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">power =</span> <span class="fl">0.80</span>,  <span class="co"># desired power level</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"paired"</span>,  <span class="co"># type of t test</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">alternative =</span> <span class="st">"two.sided"</span>  <span class="co"># alternative hypothesis</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Paired t test power calculation 

              n = 51.00945
              d = 0.4
      sig.level = 0.05
          power = 0.8
    alternative = two.sided

NOTE: n is number of *pairs*</code></pre>
</div>
</div>
</section>
<section id="webpower" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="webpower"><span class="header-section-number">3.2</span> WebPower</h2>
<p>This is a strong tool for different types of ANOVA.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>WebPower<span class="sc">::</span><span class="fu">wp.rmanova</span>(</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> <span class="cn">NULL</span>,  <span class="co"># Compute required sample size</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">ng =</span> <span class="dv">1</span>,   <span class="co"># Only one group if it's a within-subjects design</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">nm =</span> <span class="dv">3</span><span class="sc">*</span><span class="dv">3</span>,  <span class="co"># Number of measurements (n*m for n x m design)</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">f =</span> <span class="fl">0.4</span>,  <span class="co"># Effect size</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">nscor =</span> <span class="dv">1</span>,  <span class="co"># Nonsphericity correction (assumed sphericity for now)</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="fl">0.05</span>,  <span class="co"># significance level, aka alpha value</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">power =</span> <span class="fl">0.80</span>,  <span class="co"># desired power </span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="dv">1</span> <span class="co"># 0: between-effect; 1: within-effect; 2: interaction effect</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Repeated-measures ANOVA analysis

           n   f ng nm nscor alpha power
    94.86041 0.4  1  9     1  0.05   0.8

NOTE: Power analysis for within-effect test
URL: http://psychstat.org/rmanova</code></pre>
</div>
</div>
</section>
<section id="superpower" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="superpower"><span class="header-section-number">3.3</span> Superpower</h2>
<p>As the name suggests, it is super for power analysis :) However, you need to simulate your data to calculate required sample size. It might be useful to calculate actual power level. However, it is hard to create simulations in general for our studies in Visual Neuroscience Lab.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Experimental design</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>design_result <span class="ot">&lt;-</span> Superpower<span class="sc">::</span><span class="fu">ANOVA_design</span>(</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">design =</span> <span class="st">"3w*3w"</span>,  <span class="co"># 3x2 within-subjects </span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> <span class="dv">30</span>,  <span class="co"># as a start point to find the required sample size</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">mu =</span> <span class="fu">c</span>(<span class="dv">500</span>, <span class="dv">520</span>, <span class="dv">540</span>, <span class="dv">490</span>, <span class="dv">510</span>, <span class="dv">530</span>, <span class="dv">480</span>, <span class="dv">500</span>, <span class="dv">520</span>),  <span class="co"># average values for dependent variable</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">sd =</span> <span class="dv">50</span>,  <span class="co"># estimated standard deviation</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">r =</span> <span class="fl">0.5</span>,  <span class="co"># correlation between repeated measures</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">labelnames =</span> <span class="fu">c</span>(<span class="st">"Stimulus"</span>, <span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"Condition"</span>, <span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"3"</span>)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="CalculatingAPrioriPower_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># simulation for power analysis</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>Superpower<span class="sc">::</span><span class="fu">ANOVA_power</span>(design_result, <span class="at">nsims =</span> <span class="dv">1000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Power and Effect sizes for ANOVA tests
                         power effect_size
anova_Stimulus            91.7     0.21613
anova_Condition          100.0     0.49818
anova_Stimulus:Condition   4.2     0.03252

Power and Effect sizes for pairwise comparisons (t-tests)
                                                power effect_size
p_Stimulus_A_Condition_1_Stimulus_A_Condition_2  56.2   0.4114389
p_Stimulus_A_Condition_1_Stimulus_A_Condition_3  98.8   0.8149709
p_Stimulus_A_Condition_1_Stimulus_B_Condition_1  18.2  -0.2014821
p_Stimulus_A_Condition_1_Stimulus_B_Condition_2  17.5   0.2094577
p_Stimulus_A_Condition_1_Stimulus_B_Condition_3  87.9   0.6074667
p_Stimulus_A_Condition_1_Stimulus_C_Condition_1  54.7  -0.4080250
p_Stimulus_A_Condition_1_Stimulus_C_Condition_2   4.8  -0.0002508
p_Stimulus_A_Condition_1_Stimulus_C_Condition_3  54.3   0.4078128
p_Stimulus_A_Condition_2_Stimulus_A_Condition_3  57.1   0.4114054
p_Stimulus_A_Condition_2_Stimulus_B_Condition_1  88.4  -0.6114742
p_Stimulus_A_Condition_2_Stimulus_B_Condition_2  17.0  -0.2009743
p_Stimulus_A_Condition_2_Stimulus_B_Condition_3  17.1   0.2038007
p_Stimulus_A_Condition_2_Stimulus_C_Condition_1  98.8  -0.8155609
p_Stimulus_A_Condition_2_Stimulus_C_Condition_2  58.7  -0.4127176
p_Stimulus_A_Condition_2_Stimulus_C_Condition_3   4.6  -0.0009326
p_Stimulus_A_Condition_3_Stimulus_B_Condition_1  99.9  -1.0178364
p_Stimulus_A_Condition_3_Stimulus_B_Condition_2  90.2  -0.6162723
p_Stimulus_A_Condition_3_Stimulus_B_Condition_3  18.5  -0.2067831
p_Stimulus_A_Condition_3_Stimulus_C_Condition_1 100.0  -1.2164737
p_Stimulus_A_Condition_3_Stimulus_C_Condition_2  98.7  -0.8183807
p_Stimulus_A_Condition_3_Stimulus_C_Condition_3  56.8  -0.4113965
p_Stimulus_B_Condition_1_Stimulus_B_Condition_2  57.2   0.4107193
p_Stimulus_B_Condition_1_Stimulus_B_Condition_3  98.5   0.8163435
p_Stimulus_B_Condition_1_Stimulus_C_Condition_1  18.8  -0.2056545
p_Stimulus_B_Condition_1_Stimulus_C_Condition_2  20.1   0.2019636
p_Stimulus_B_Condition_1_Stimulus_C_Condition_3  86.9   0.6117364
p_Stimulus_B_Condition_2_Stimulus_B_Condition_3  54.4   0.4024908
p_Stimulus_B_Condition_2_Stimulus_C_Condition_1  88.9  -0.6152891
p_Stimulus_B_Condition_2_Stimulus_C_Condition_2  19.0  -0.2091239
p_Stimulus_B_Condition_2_Stimulus_C_Condition_3  17.6   0.1982006
p_Stimulus_B_Condition_3_Stimulus_C_Condition_1 100.0  -1.0163861
p_Stimulus_B_Condition_3_Stimulus_C_Condition_2  87.2  -0.6108055
p_Stimulus_B_Condition_3_Stimulus_C_Condition_3  17.7  -0.2029182
p_Stimulus_C_Condition_1_Stimulus_C_Condition_2  54.6   0.4063266
p_Stimulus_C_Condition_1_Stimulus_C_Condition_3  98.8   0.8163164
p_Stimulus_C_Condition_2_Stimulus_C_Condition_3  55.8   0.4080156


Within-Subject Factors Included: Check MANOVA Results</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Power and Effect sizes for ANOVA tests
                         power effect_size
anova_Stimulus            91.7     0.21613
anova_Condition          100.0     0.49818
anova_Stimulus:Condition   4.2     0.03252

Power and Effect sizes for pairwise comparisons (t-tests)
                                                power effect_size
p_Stimulus_A_Condition_1_Stimulus_A_Condition_2  56.2   0.4114389
p_Stimulus_A_Condition_1_Stimulus_A_Condition_3  98.8   0.8149709
p_Stimulus_A_Condition_1_Stimulus_B_Condition_1  18.2  -0.2014821
p_Stimulus_A_Condition_1_Stimulus_B_Condition_2  17.5   0.2094577
p_Stimulus_A_Condition_1_Stimulus_B_Condition_3  87.9   0.6074667
p_Stimulus_A_Condition_1_Stimulus_C_Condition_1  54.7  -0.4080250
p_Stimulus_A_Condition_1_Stimulus_C_Condition_2   4.8  -0.0002508
p_Stimulus_A_Condition_1_Stimulus_C_Condition_3  54.3   0.4078128
p_Stimulus_A_Condition_2_Stimulus_A_Condition_3  57.1   0.4114054
p_Stimulus_A_Condition_2_Stimulus_B_Condition_1  88.4  -0.6114742
p_Stimulus_A_Condition_2_Stimulus_B_Condition_2  17.0  -0.2009743
p_Stimulus_A_Condition_2_Stimulus_B_Condition_3  17.1   0.2038007
p_Stimulus_A_Condition_2_Stimulus_C_Condition_1  98.8  -0.8155609
p_Stimulus_A_Condition_2_Stimulus_C_Condition_2  58.7  -0.4127176
p_Stimulus_A_Condition_2_Stimulus_C_Condition_3   4.6  -0.0009326
p_Stimulus_A_Condition_3_Stimulus_B_Condition_1  99.9  -1.0178364
p_Stimulus_A_Condition_3_Stimulus_B_Condition_2  90.2  -0.6162723
p_Stimulus_A_Condition_3_Stimulus_B_Condition_3  18.5  -0.2067831
p_Stimulus_A_Condition_3_Stimulus_C_Condition_1 100.0  -1.2164737
p_Stimulus_A_Condition_3_Stimulus_C_Condition_2  98.7  -0.8183807
p_Stimulus_A_Condition_3_Stimulus_C_Condition_3  56.8  -0.4113965
p_Stimulus_B_Condition_1_Stimulus_B_Condition_2  57.2   0.4107193
p_Stimulus_B_Condition_1_Stimulus_B_Condition_3  98.5   0.8163435
p_Stimulus_B_Condition_1_Stimulus_C_Condition_1  18.8  -0.2056545
p_Stimulus_B_Condition_1_Stimulus_C_Condition_2  20.1   0.2019636
p_Stimulus_B_Condition_1_Stimulus_C_Condition_3  86.9   0.6117364
p_Stimulus_B_Condition_2_Stimulus_B_Condition_3  54.4   0.4024908
p_Stimulus_B_Condition_2_Stimulus_C_Condition_1  88.9  -0.6152891
p_Stimulus_B_Condition_2_Stimulus_C_Condition_2  19.0  -0.2091239
p_Stimulus_B_Condition_2_Stimulus_C_Condition_3  17.6   0.1982006
p_Stimulus_B_Condition_3_Stimulus_C_Condition_1 100.0  -1.0163861
p_Stimulus_B_Condition_3_Stimulus_C_Condition_2  87.2  -0.6108055
p_Stimulus_B_Condition_3_Stimulus_C_Condition_3  17.7  -0.2029182
p_Stimulus_C_Condition_1_Stimulus_C_Condition_2  54.6   0.4063266
p_Stimulus_C_Condition_1_Stimulus_C_Condition_3  98.8   0.8163164
p_Stimulus_C_Condition_2_Stimulus_C_Condition_3  55.8   0.4080156</code></pre>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/visualneuroscience">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>